%%%
%% Generated by Chef
%%%

[
<% if node['rabbitmq']['port_range'] -%>
  {kernel, [{inet_dist_listen_min, <%= node['rabbitmq']['port_range'].first %>},{inet_dist_listen_max, <%= node['rabbitmq']['port_range'].last %>}]},
<% end %>
  {rabbit, [
<% if node['rabbitmq']['cluster'] -%>
    <% if node['rabbitmq']['cluster_disk_nodes'] -%>
        {cluster_nodes, [{<%= node['rabbitmq']['cluster_disk_nodes'].map{|n| "\'#{n}\'"}.join(',') %>,disc}]},
    <% end %>
    {cluster_partition_handling,<%= node['rabbitmq']['cluster_partition_handling'] %>},
<% end %>
<% if node['rabbitmq']['ssl'] -%>
    {ssl_listeners, [<%= node['rabbitmq']['ssl_port'] %>]},
    {ssl_options, [{cacertfile,"<%= node['rabbitmq']['ssl_cacert'] %>"},
                    {certfile,"<%= node['rabbitmq']['ssl_cert'] %>"},
                    {keyfile,"<%= node['rabbitmq']['ssl_key'] %>"},
                    {verify,verify_none},
                    {fail_if_no_peer_cert,false}]},
<% end %>
    {default_user, <<"<%= node['rabbitmq']['default_user'] %>">>},
    {default_pass, <<"<%= node['rabbitmq']['default_pass'] %>">>}
  ]}
].
